---
- assert:
    that: zend_chain_seed_move|d()
    msg: Won't attempt blockchain seed move

- name: Move blockchain
  block:
    - name: Move blockchain blocks
      command: mv {{ zend_chain_seed_path }}/blocks {{ zend_dir }}
      args:
        removes: "{{ zend_chain_seed_path }}/blocks"
        creates: "{{ zend_dir }}/blocks"
    - name: Move blockchain chainstate
      command: mv {{ zend_chain_seed_path }}/chainstate {{ zend_dir }}
      args:
        removes: "{{ zend_chain_seed_path }}/chainstate"
        creates: "{{ zend_dir }}/chainstate"
  rescue:
    - name: Replace blockchain blocks
      command: mv {{ zend_dir }}/blocks {{ zend_chain_seed_path }}
      args:
        removes: "{{ zend_dir }}/blocks"
        creates: "{{ zend_chain_seed_path }}/blocks"
      ignore_errors: true
    - name: Replace blockchain chainstate
      command: mv {{ zend_dir }}/chainstate {{ zend_chain_seed_path }}
      args:
        removes: "{{ zend_dir }}/chainstate"
        creates: "{{ zend_chain_seed_path }}/chainstate"
      ignore_errors: true
    - fail:
        msg: "{{ ansible_failed_task }} failed"
