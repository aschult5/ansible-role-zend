- name: Check required zen_dir variables
  assert:
    that:
      - zennode_user_name is defined
      - zennode_zen_conf is defined
      - zennode_zen_dir is defined
      - zennode_wallet_dir is defined
      - zennode_skip_blockchain is defined
      - zennode_ip is defined
    msg: Required variable missing.

# Zen directory setup
- name: Create zen directory
  file:
    path: "{{ zennode_zen_dir }}"
    state: directory
    owner: "{{ zennode_user_name }}"
- name: Create wallet directory
  file:
    path: "{{ zennode_wallet_dir }}"
    state: directory
    owner: "{{ zennode_user_name }}"

- name: Zen configuration file
  template:
    src: zen_conf.j2
    dest: "{{ zennode_zen_conf }}"
    owner: "{{ zennode_user_name }}"
    mode: 0644

- import_tasks: zen_chain.yml
  when: zennode_skip_blockchain == false

- import_tasks: zen_wallet.yml
  when: zennode_skip_wallet == false

- name: Set zen directory owner
  file:
    path: "{{ zennode_zen_dir }}"
    state: directory
    owner: "{{ zennode_user_name }}"
    recurse: yes
